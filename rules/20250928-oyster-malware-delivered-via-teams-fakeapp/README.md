# Sigma Rules for Oyster Malware Detection

This folder contains Sigma rules for detecting the Oyster malware, a threat that delivers payloads via fake Teams applications and establishes command-and-control (C2) communications.

## Rules

### Delivery Rules
- **20250928-delivery-oyster-via-teams-fakeapp.yaml**: Detects HTTP requests associated with Oyster delivery via Teams FakeApp, including OPTIONS/POST to `/create/link`, GET to `/gov/` paths, and GET to `download-script[0-9]{0,4}.js` with specific Referer headers.
- **20250928-delivery-oyster-js-exploit-kit.yaml**: Detects JavaScript files used in the Oyster malware delivery exploit kit by matching specific function names, API paths, and headers.

### Execution Rules
- **20250928-execution-oyster-scheduled-task-creation.yaml**: Detects the creation of scheduled tasks by Oyster malware using `schtasks.exe` to run `rundll32.exe` every 11 minutes.

### C2 Rules
- **20250928-c2-oyster-beaconing-traffic.yaml**: Detects HTTP beaconing traffic from Oyster malware to C2 servers, including requests to `/reg`, `/login`, and API endpoints with specific User-Agents and methods.

## Usage

These Sigma rules can be used with Sigma-compatible tools to detect Oyster malware activity in logs. They can also be converted to YARA rules for file-based detection or integrated into SIEM systems.

## Reference

For more details on the Oyster malware and its detection, see the article: [Oyster Malware Delivery via Teams Fake App](https://malasada.tech/oyster-malware-delivery-via-teams-fake-app/)

## License

This repository is licensed under the MIT License. See `LICENSE` for details.