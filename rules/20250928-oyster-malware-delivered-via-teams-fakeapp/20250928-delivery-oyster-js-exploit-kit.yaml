title: Oyster Malware Delivery JavaScript Exploit Kit Detection
id: 0fedcba9-8765-4321-0fed-cba987654321
status: experimental
description: Detects JavaScript code used in the Oyster malware delivery exploit kit, matching specific function and variable names, API paths, and headers.
author: MalasadaTech
logsource:
  category: file
detection:
  selection:
    file.content|contains|all:
      - 'checkUrlAvailability'
      - 'generationUrlCreate'
      - '/create/link'
      - 'Content-Encoding'': ''msteams'''
      - '#downloadButton'
      - 'apiUrls'
      - 'generationUrlDownload'
  condition: selection
fields:
  - file.name
  - file.path
falsepositives:
  - Legitimate JavaScript files with similar variable names and structures.
level: medium