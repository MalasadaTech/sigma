title: Oyster Malware C2 Beaconing Traffic
id: ecf27223-9bf5-4d0d-970b-d068903ab9fa
status: experimental
description: Detects HTTP requests indicative of Oyster malware C2 beaconing, including GET requests to /reg with WordPressAgent User-Agent and application/json Content-Type, GET requests to /login with FingerPrint User-Agent, and GET/POST requests to /api/kcehc or POST requests to /api/jgfnsfnuefcnegfnehjbfncejfh.
author: MalasadaTech
date: 2025/09/28
logsource:
  category: firewall
detection:
  selection_reg:
    http.method: 'GET'
    http.url|contains: '/reg'
    http.request.headers.User-Agent: 'WordPressAgent'
    http.request.headers.Content-Type: 'application/json'
  selection_login:
    http.method: 'GET'
    http.url|contains: '/login'
    http.request.headers.User-Agent: 'FingerPrint'
  selection_kcehc:
    http.url|contains: '/api/kcehc'
    http.method:
      - 'GET'
      - 'POST'
  selection_jgfnsfnuefcnegfnehjbfncejfh:
    http.url|contains: '/api/jgfnsfnuefcnegfnehjbfncejfh'
    http.method: 'POST'
  condition: selection_reg or selection_login or selection_kcehc or selection_jgfnsfnuefcnegfnehjbfncejfh
fields:
  - http.method
  - http.url
  - http.request.headers.User-Agent
  - http.request.headers.Content-Type
falsepositives:
  - Legitimate GET requests to /reg with WordPressAgent User-Agent and application/json Content-Type.
  - Legitimate GET requests to /login with FingerPrint User-Agent.
  - Legitimate requests to /api/kcehc or /api/jgfnsfnuefcnegfnehjbfncejfh with matching methods.
level: medium
references:
  - https://malasada.tech/oyster-malware-delivery-via-teams-fake-app/