title: Oyster Malware C2 Beaconing Traffic
id: 98765432-10fe-dcba-9876-543210fedcba
status: experimental
description: Detects HTTP requests indicative of Oyster malware C2 beaconing, including GET requests to /reg with WordPressAgent User-Agent and application/json Content-Type, GET requests to /login with FingerPrint User-Agent, and GET/POST requests to /api/kcehc or POST requests to /api/jgfnsfnuefcnegfnehjbfncejfh.
author: MalasadaTech
logsource:
  category: firewall
detection:
  selection_reg:
    http.method: 'GET'
    http.url|contains: '/reg'
    http.request.headers.User-Agent: 'WordPressAgent'
    http.request.headers.Content-Type: 'application/json'
  selection_login:
    http.method: 'GET'
    http.url|contains: '/login'
    http.request.headers.User-Agent: 'FingerPrint'
  selection_kcehc:
    http.url|contains: '/api/kcehc'
    http.method:
      - 'GET'
      - 'POST'
  selection_jgfnsfnuefcnegfnehjbfncejfh:
    http.url|contains: '/api/jgfnsfnuefcnegfnehjbfncejfh'
    http.method: 'POST'
  condition: selection_reg or selection_login or selection_kcehc or selection_jgfnsfnuefcnegfnehjbfncejfh
fields:
  - http.method
  - http.url
  - http.request.headers.User-Agent
  - http.request.headers.Content-Type
falsepositives:
  - Legitimate GET requests to /reg with WordPressAgent User-Agent and application/json Content-Type.
  - Legitimate GET requests to /login with FingerPrint User-Agent.
  - Legitimate requests to /api/kcehc or /api/jgfnsfnuefcnegfnehjbfncejfh with matching methods.
level: medium